
# 第一章     数据科学-鸟瞰
&emsp;&emsp;数据科学或机器学习是让机器能够在不被告知或编程的情况下从数据集中学习的过程。例如，很难编写一个程序可以将手写数字并根据所写的图像从0-9中作为输入图像。这同样适用于将收到的电子邮件归类为垃圾邮件或非垃圾邮件的任务。为了解决这些任务，数据科学家从数据科学或机器学习领域使用这些来教计算机如何自动识别数字，给它一些解释功能，可以区分一个数字和另一个数字。同为针对垃圾邮件/非垃圾邮件的问题，我们可以通过特定的学习算法来教计算机如何对邮件进行分类，而不是使用正则表达式和编写上百条规则来对收到的电子邮件进行分类垃圾邮件和非垃圾邮件。<br><br>
&emsp;&emsp;对于垃圾邮件过滤应用程序，您可以使用基于规则的方法对其进行编码，但它不足以用于在你的邮件服务器中。建立一个学习系统是一个理想的解决方案。
您可能每天都在使用数据科学的应用程序，通常是在不知情的情况下使用。例如，您的国家可能正在使用一个系统来检测您寄出的信件的邮政编码，若要自动将其转发到正确的区域。如果你在使用亚马逊，他们经常推荐你购买的东西，是因为他们通过了解你经常搜索或购买的东西来做到这一点。<br>
&emsp;&emsp;建立一个经过学习/训练的机器学习算法将需要一个历史数据样本库，它将学习如何区分不同的示例并提出这样的方法，从这些数据中获得了知识和趋势。在那之后，受过训练的算法可用于对未见数据进行预测。学习算法将使用原始历史数据，并尝试从这些数据中获得一些知识和趋势。<br><br>
&emsp;&emsp;在本章中，我们将对数据科学有一个鸟瞰的视角，它是如何作为一个黑匣子工作的，以及数据科学家每天面临的挑战。我们将涵盖以下内容题目：
<br>
&emsp;&emsp;&emsp;&emsp;1.	通过一个例子了解数据科学<br>
&emsp;&emsp;&emsp;&emsp;2.	设计数据科学算法的过程<br>
&emsp;&emsp;&emsp;&emsp;3.	开始学习<br>
&emsp;&emsp;&emsp;&emsp;4.	鱼类识别/检测模型的实现<br>
&emsp;&emsp;&emsp;&emsp;5.	不同学习类型<br>
&emsp;&emsp;&emsp;&emsp;6.	数据大小和行业需求<br>
<br><br>
## 通过一个例子了解数据科学
&emsp;&emsp;为了说明为特定数据构建学习算法的生命周期和挑战，让我们考虑一个实际的例子。自然保护协会正在与其他渔业公司和部门合作渔农处负责监察渔业活动，并为日后的渔业作出保护。因此，他们希望在未来使用相机来扩大这一监测过程。这些摄像机的部署将产生大量的数据，手工处理将十分繁琐和昂贵。因此，该部门希望开发一种自动测试的学习算法。对不同种类的鱼类进行总体检测和分类，加快视频审查过程。<br>
![](https://github.com/computeryanjiusheng2018/infodlt/blob/master/content/chapter01/%E5%9B%BE%E7%89%871.png) <br>
图1.1显示了一个由保护配置相机拍摄的图像样本,这些图像将用于构建系统。<br><br>

&emsp;&emsp;因此，我们在这个例子中的目的是分离不同的物种，如金枪鱼，月鱼，和更多的渔船捕获的鱼。作为一个说明性的例子，我们可以将问题限制为两类，即金枪鱼和月鱼。<br>
![](https://github.com/computeryanjiusheng2018/infodlt/blob/master/content/chapter01/%E5%9B%BE%E7%89%872.png) <br>
图1.2 金枪鱼(左)和月鱼(右)<br><br>
&emsp;&emsp;在限制我们的问题只包含两种类型的鱼之后，我们可以从我们收集的一些随机图像中抽取一个样本，并开始注意这两种类型之间的一些物理区别。考试请考虑以下物理差异：<br>
&emsp;&emsp;&emsp;&emsp;长度：你可以看到，与月鱼相比，金枪鱼长得很长。<br>
&emsp;&emsp;&emsp;&emsp;宽度：月鱼比金枪鱼宽。<br>
&emsp;&emsp;&emsp;&emsp;颜色：你可以看到，月鱼倾向于红色，而金枪鱼则倾向于蓝色和白色，依此类推。<br>
我们可以利用这些物理差异作为特征，帮助我们的学习算法(分类器)区分这两种类型的鱼。<br>
&emsp;&emsp;对象的解释特征是我们在日常生活中用来区分周围事物的东西。甚至婴儿也会利用这些解释功能来了解周围的环境。数据科学也是如此，以便建立一个能够区分不同对象(例如，鱼类类型)的学习模型，我们需要给它一些可供学习的解释特性(例如，鱼的长度)。为了使模型更加确定，减少混淆误差，可以在一定程度上增加对象的解释特征。<br>
&emsp;&emsp;鉴于这两种鱼类之间的物理差异，这两种不同的鱼类种群有不同的模型或描述。因此，我们分类任务的最终目标是让分类器学习这些不同的模型，然后给出这两种类型之一的图像作为输入。分类器将通过选择与此图像最匹配的模型(金枪鱼模型或月鱼模型)对其进行分类。<br>
&emsp;&emsp;在这种情况下，金枪鱼和月鱼的收集将作为我们分类器的知识库。最初，知识库(训练样本)将被标记/标记，对于每个图像，您将事先知道它是金枪鱼还是月鱼。因此，分类器将使用这些训练样本来建模不同类型的鱼，然后我们可以使用训练阶段的输出来自动标记未标记/未标记的鱼，即分类在训练阶段没有看到。这种未标记的数据通常称为看不见的数据。生命周期的培训阶段如下图所示：监督数据科学是从已知目标或输出的历史数据(如鱼类类型)中学习，然后使用这个学习模型来预测我们不知道目标/输出案例或数据样本。<br>
![](https://github.com/computeryanjiusheng2018/infodlt/blob/master/content/chapter01/1图片.png) <br>
图1.3 训练阶段运行周期<br><br>
&emsp;&emsp;让我们看看分类器的培训阶段将如何工作：<br>
&emsp;&emsp;&emsp;&emsp;预处理：在这一步中，我们将尝试利用相关的分割技术从图像中分割出鱼。<br>
&emsp;&emsp;&emsp;&emsp;特征提取：通过减去背景将鱼从图像中分割出来，然后测量每幅图像的物理差异(长度、宽度、颜色等)。最后，你会得到一些信息如图1.4所示。<br>
&emsp;&emsp;最后，我们将这些数据输入到分类器中，以便对不同的鱼类类型进行建模。正如我们所看到的，我们可以根据我们提出的物理差异(如长度、宽度和颜色)，在视觉上区分金枪鱼和月鱼。<br>
&emsp;&emsp;我们可以利用长度特征来区分这两种鱼。因此，我们可以通过观察它们的长度和它是否超过某个值(长度)来区分它们。<br>
&emsp;&emsp;因此，根据我们的培训样本，我们可以得出以下规则：<br>
```python
If length(fish)> length* then label(fish) =Tuna 
Otherwise label(fish) = Opah
```  
&emsp;&emsp;为了找到这个长度，我们可以根据训练样本进行长度测量。因此，假设我们得到这些长度测量，并得到如下直方图：<br>
![](https://github.com/computeryanjiusheng2018/infodlt/blob/master/content/chapter01/2图片.png) <br>
图1.4 两种鱼类长度测量的直方图<br><br>
&emsp;&emsp;在这种情况下，我们可以根据长度特征导出一个规则，并区分金枪鱼和月鱼。在这个特殊的例子中，我们可以知道长度是7。这样我们就可以更新前面的规则：<br>
```python
If length(fish)> 7 then label(fish) =Tuna 
Otherwise label(fish) = Opah
```  
&emsp;&emsp;正如您可能注意到的，这不是一个有希望的结果，因为这两个直方图之间的重叠，因为长度特征不是一个完美的特点，仅用于区分这两种类型。因此，我们可以尝试合并更多的功能，如宽度，然后结合他们。因此，如果我们设法测量训练样本的宽度，我们可能会得到类似于跟随，接着:<br>
![](https://github.com/computeryanjiusheng2018/infodlt/blob/master/content/chapter01/图片3.png) <br>
图1.5 两种鱼类宽度测量的直方图<br><br>
&emsp;&emsp;正如您所看到的，依赖于一个特性不会给出准确的结果，输出模型会造成许多错误分类。所以，我们可以用某种方式将这两个特性结合起来，使其看上去很合理。<br>
&emsp;&emsp;因此，如果我们将这两个特性结合起来，我们可能会得到类似于下面的图形的东西：<br>
![](https://github.com/computeryanjiusheng2018/infodlt/blob/master/content/chapter01/图片4.png) <br>
图1.6 两种鱼类的长度和宽度测量子集之间的组合<br><br>
&emsp;&emsp;结合长度和宽度特征的读数，我们将得到像前面的图表中的散点图。我们有红色的点代表金枪鱼，绿色的点代表opah鱼，我们可以建议这条黑线作为区分这两种鱼的规则或决策边界。例如，如果一条鱼的读数高于这个决定边界，那么它就是一条金枪鱼；否则，它将被预测为一条月鱼。<br>
&emsp;&emsp;我们可以设法增加规则的复杂性，以避免任何错误，并获得如下图形中的决策边界：<br>
![](https://github.com/computeryanjiusheng2018/infodlt/blob/master/content/chapter01/图片5.png) <br>
图1.7 增加决策边界的复杂性以避免对培训数据的错误分类<br><br>
&emsp;&emsp;该模型的优点是我们在训练样本上得到了几乎0种错误分类。但实际上，这并不是使用数据科学的目的。数据科学的目标是建立一个模型，该模型能够对未见的数据进行良好的概括和执行。为了了解我们是否建立了一个推广的模型，我们将引入一个新的阶段，称为测试阶段，在这个阶段中，我们给训练的模型一个未标记的图像并希望模型可以指定正确的标签(Tuna和opah)。<br>
&emsp;&emsp;数据科学的最终目标是建立一个在生产中运行良好的模型，而不是训练集。所以，当你看到你的模型在训练中表现良好时，不要高兴，就像图1.7中的模型一样。大多数情况下，这种模型在识别图像中的鱼类类型时效果不佳。你的模型只有在训练集上才能正常工作，这一事件被称为“过度拟合”，而且大多数从业者都落入了这个陷阱。<br>
&emsp;&emsp;代替提出这样一个复杂的模型，您可以使用一个不那么复杂的模型，它将在测试阶段泛化。下图显示了如何使用不太复杂的模型来获得较少的错误分类错误，并对未见数据进行概括：<br>
![](https://github.com/computeryanjiusheng2018/infodlt/blob/master/content/chapter01/图片6.png) <br>
图 1.8 使用不太复杂的模型，以便能够对测试样本(未见数据)进行归纳。<br><br>
## 数据科学算法的设计过程
&emsp;&emsp;不同的学习系统通常遵循相同的设计过程。它们从获取知识库开始，从数据中选择相关的解释性特征，通过一系列候选学习算法，同时关注每一个算法，最后是评估过程，衡量培训过程的成功程度。<br>
&emsp;&emsp;在本节中，我们将更详细地讨论所有这些不同的设计步骤：<br>
![](https://github.com/computeryanjiusheng2018/infodlt/blob/master/content/chapter01/图片7.png) <br>
图1.11 “模型学习过程大纲”<br><br>
### 数据预处理
&emsp;&emsp;学习周期的这一部分代表了我们算法的知识库。因此，为了帮助学习算法对未知数据做出准确的决策，我们需要以最好的形式提供这个知识库。因此，我们的数据可能需要大量的清理和预处理(转换)。<br>
#### 数据清理
&emsp;&emsp;大多数数据集都需要这个步骤，在这个步骤中，您可以消除错误、噪声和冗余。我们需要我们的数据准确、完整、可靠和不偏不倚，因为使用不好的知识库可能会产生许多问题，例如：<br>
&emsp;&emsp;&emsp;&emsp;1.不准确和有偏见的结论<br>
&emsp;&emsp;&emsp;&emsp;2.增加误差<br>
&emsp;&emsp;&emsp;&emsp;3.降低了通用性，这是该模型能够很好地处理它以前没有训练过的未见数据<br>
##### 数据预处理
&emsp;&emsp;在这一步中，我们将对数据进行一些转换，以使其一致和具体。在预处理数据时，您可以考虑许多不同的转换：<br>
&emsp;&emsp;&emsp;&emsp;重命名：这意味着将分类值转换为数字，因为如果与某些学习方法一起使用，则分类值是危险的，而且数字也会在这些值之间强制排序。<br>
&emsp;&emsp;&emsp;&emsp;重新标度(正常化)：将连续值转换/包围到某个范围，典型地 [-1,1]或[0,1]<br>
&emsp;&emsp;&emsp;&emsp;新特点：从现有的特征中提炼出新的特征。例如，肥胖因素=体重/身高。<br>
### 特征选择
&emsp;&emsp;一个样本的解释特性(输入变量)的数量可能是巨大的，当您获得xi=(xi,xi^2,xi^3,...,xi^d)作为训练样本(观察/示例)时，d是非常大的。这方面的一个例子可以是文档分类任务，如您得到了10000个不同的单词，而输入变量将是不同单词出现的次数。<br>
&emsp;&emsp;大量的输入变量可能是有问题的，有时也是一个麻烦，因为我们有很多输入变量和很少的训练样本来帮助我们学习过程。为了避免有大量的输入变量(维数的麻烦)，数据科学家使用降维技术从输入变量中选择一个子集。例如，在文本分类任务中，他们可以执行以下操作：<br>
&emsp;&emsp;&emsp;&emsp;1.提取相关输入(例如，相互信息度量)<br>
&emsp;&emsp;&emsp;&emsp;2.主成分分析（PCA）<br>
&emsp;&emsp;&emsp;&emsp;3.分组(聚类)相似的单词(这使用相似性度量)<br>
### 模型选择
&emsp;&emsp;这一步是在使用任何降维技术来选择输入变量的适当子集之后执行的。选择输入变量的适当子集将使学习过程的其余部分非常简单。在这一步中，您正试图找到需要学习的正确模型。<br>
&emsp;&emsp;如果您有任何数据科学的经验，并将学习方法应用于不同领域和不同类型的数据，那么您将发现这一步骤很容易，因为它需要事先了解。现在你的数据看起来，什么样的假设符合你的数据的性质，并在此基础上，你选择了正确的学习方法。如果您没有任何先验知识，这也没关系，因为您可以通过猜测和尝试不同参数设置的不同学习方法来完成这一步，并选择给它一个比测试集的性能更好的方法。<br>
&emsp;&emsp;此外，初始数据分析和可视化将帮助您很好地猜测数据的分布形式和性质。<br>
### 学习过程
&emsp;&emsp;通过学习，我们指的是用于选择最佳模型参数的优化标准。这方面有各种优化标准：<br>
&emsp;&emsp;&emsp;&emsp;1.均方误差<br>
&emsp;&emsp;&emsp;&emsp;2.最大似然准则<br>
&emsp;&emsp;&emsp;&emsp;3. 最大后验概率<br>
&emsp;&emsp;优化问题可能很难解决，但模型和误差函数的正确选择会带来很大的影响。<br>
### 评估模型
&emsp;&emsp;在这一步中，我们尝试测量我们的模型对未见数据的泛化误差。由于我们只有特定的数据而事先不知道任何看不见的数据，所以我们可以随机地从数据中选择一个测试集，并且在训练过程中不要使用它，它的作用就像有效的看不见的数据。可以通过不同的方法来评估所选模型的性能：<br>
&emsp;&emsp;&emsp;&emsp;1.简单的持久化方法，将数据划分为训练集和测试集。<br>
&emsp;&emsp;&emsp;&emsp;2.其他基于交叉验证和随机次抽样的复杂方法<br>
&emsp;&emsp;我们在这一步的目标是比较不同模型在相同数据上的预测性能，并选择一个测试误差较好(较小)的模型，这将给我们带来更好的结果。对未见数据的泛化错误。通过使用统计方法测试结果的重要性，您也可以更确定泛化错误。<br>
## 学习
&emsp;&emsp;构建机器学习系统会带来一些挑战和问题，我们将在本节中讨论这些挑战和问题。这些问题中有许多是特定领域的，而另一些则不是。<br>
### 学习面临的挑战
&emsp;&emsp;以下概述了您在构建学习系统时通常将面临的挑战和问题。<br>
#### 特征提取-特征工程
&emsp;&emsp;特征提取是构建学习系统的关键步骤之一。如果您在这个挑战中做得很好，选择适当的/正确的特性数，那么剩下的学习内容过程将很容易。此外，特征提取与领域有关，需要事先了解哪些特征对特定任务可能很重要。例如，我们的鱼类识别系统的功能将不同于垃圾邮件检测或识别指纹。<br>
&emsp;&emsp;特征提取步骤从您拥有的原始数据开始。然后构建关于学习任务信息的派生变量/值(特性)，并为下一步的学习和评估(泛化)提供便利。<br>
&emsp;&emsp;一些任务将具有大量的特征和较少的训练样本(观察)，以促进后续的学习和概括过程。在这种情况下，数据科学家使用降维技术将大量的特征减少到更小的集合。<br>
#### 其他因素
&emsp;&emsp;在鱼的识别任务中，你可以看到鱼的长度、重量、鱼的颜色以及船的颜色可能不同，而且在图像中可能会出现阴影、低分辨率的图像和其他物体。所有这些问题都会影响到建议的解释性特征的重要性，这些特征应该是关于我们的鱼类分类任务的信息。<br>
&emsp;&emsp;在这种情况下，工作是有帮助的。例如，有人可能会想到检测船ID，并屏蔽船的某些部分，这些部分很可能不包含我们的系统检测到的任何鱼。这项工作将限制我们的搜索空间。<br>
#### 过拟合
&emsp;&emsp;在鱼类识别任务中，我们试图通过增加模型的复杂性和对训练样本的每一个实例进行完美的分类来提高模型的性能。正如我们稍后将看到的，这样的模型不适用于看不见的数据(例如我们将用于测试模型性能的数据)。如果训练的模型在训练样本上工作得很好，但在测试样本上却没有很好的表现，这就被称为过度拟合。<br>
&emsp;&emsp;如果您仔细阅读本章的后半部分，我们将建立一个学习系统，目的是将训练样本作为我们模型的知识库，以便从看不见的数据中学习和推广。训练模型的性能误差对训练数据不感兴趣；相反，我们感兴趣的是经过训练的模型在还没有进入训练阶段的测试样本上的性能(泛化)误差。<br>
#### 机器学习算法的选择
&emsp;&emsp;有时，您对用于特定任务的模型的执行不满意，并且需要另一个模型类。每种学习策略都有自己的假设。关于它将用作学习基础的信息。作为信息研究人员，您必须发现哪些怀疑最适合您的信息；通过这一点，您将有能力尝试一种模型并拒绝另一种模型。<br>
#### 先验知识准备
&emsp;&emsp;正如在模型选择和特征提取的概念中所讨论的，如果您事先了解以下内容，则可以处理这两个问题：<br>
&emsp;&emsp;&emsp;&emsp;1.适当的特征<br>
&emsp;&emsp;&emsp;&emsp;2.模型选择部分<br>
&emsp;&emsp;对鱼类识别系统中的解释性特征的先验了解使我们能够在不同类型的鱼中进行区分。我们可以通过努力想象我们的信息来进行宣传，并对不同鱼类分类的信息类型有一定的了解。在此基础上，可以选择APT模型族。<br>
#### 缺失值
&emsp;&emsp;缺少功能主要是因为缺少数据或选择“不告诉”选项。在学习过程中，我们如何处理这种情况呢？例如，假设我们发现特定鱼类类型的宽度由于某种原因而丢失。有许多方法可以处理这些缺失的功能。<br>
## 鱼类识别/检测模型的实现
&emsp;&emsp;为了特别介绍机器学习和深度学习的功能，我们将实现鱼的识别实例。不需要了解代码的内部细节。本节的重点是概述一个典型的机器学习管道。<br>
&emsp;&emsp;我们对这一任务的知识库将是一堆图像，每个图片都被标记为opah或tuna。对于这个实现，我们将使用一种在成像和计算机视觉领域取得突破的深度学习架构。这种结构称为卷积神经网络(CNNs)。它是一种深度学习结构，它利用图像处理的卷积运算从图像中提取特征，从而解释我们想要分类的对象。现在，你可以把它想象成一个魔盒，它将拍摄我们的图像，从中学习如何区分我们的两个类(opah和tuna)，然后我们将测试这个盒子的学习过程。用未贴标签的图片进行测试，看看它是否能分辨出图像中是哪种鱼。<br>
&emsp;&emsp;不同类型的学习将在后面的一节中讨论，因此稍后您将了解为什么我们的鱼识别任务属于监督学习类别。<br>
&emsp;&emsp;在本例中，我们将使用Keras。目前，您可以将Keras看作是一个API，它使构建和使用深度学习的方式比平常更容易。我们开始吧！我们在Keras网站上有：<br>
&emsp;&emsp;&emsp;&emsp;Keras是一个高级的神经网络API，用Python编写，能够运行在TensorFlow、CNTK或Theano之上。它是以快速试验为重点开发的。能从一个想法到另一个结果，尽可能少的延迟是做好研究的关键。<br>
### 知识库/数据集
&emsp;&emsp;正如我们前面提到的，我们需要一个历史数据基础，用来教学习算法关于它以后应该完成的任务。但是我们还需要另一个数据集来测试它在学习过程之后完成任务的能力。总之，在学习过程中，我们需要两种类型的数据集：<br>
&emsp;&emsp;&emsp;&emsp;1.第一个是知识库，其中有输入数据及其相应的标签，如鱼类图像及其相应的标签(opah或tuna)。这些数据将被输入学习算法中，从中学习，并试图发现模式/趋势，这将有助于对未标记的图像进行分类。<br>
&emsp;&emsp;&emsp;&emsp;2.第二种主要是测试模型的能力，将它从知识库中学到的东西应用到未标记的图像或未见数据上，看看它是否正常工作。<br>

&emsp;&emsp;正如你所看到的，我们只有作为学习方法的知识库的数据。我们手头的所有数据都有与之相关的正确输出。因此，我们需要以某种方式组成这些数据，这些数据没有任何与其相关的正确输出(我们将对其应用该模型)。<br>
&emsp;&emsp;在执行数据科学时，我们将执行以下操作：<br>
&emsp;&emsp;&emsp;&emsp;培训阶段：我们从知识库中提供我们的数据，并通过将输入的数据及其正确的输出输入模型中来训练我们的学习方法/模型。<br>
&emsp;&emsp;&emsp;&emsp;验证/测试阶段：在这一阶段，我们将衡量这个经过训练的模型做得有多好。我们还使用不同的模型属性技术来衡量我们训练过的模型的性能。（分类器的分类错误，IR模型的返回和精度，等等)。<br>

&emsp;&emsp;验证/测试阶段通常分为两个步骤：<br>
&emsp;&emsp;&emsp;&emsp;1.在第一步中，我们使用不同的学习方法/模型，并根据验证数据(验证步骤)选择性能好的学习方法/模型。<br>
&emsp;&emsp;&emsp;&emsp;2.然后根据测试集(测试步骤)对所选模型的精度进行测量和报告。<br>
&emsp;&emsp;现在，让我们看看我们如何得到这些数据，我们将应用这个模型，并看看它的训练有多好。<br>

&emsp;&emsp;由于没有正确的输出，我们没有任何训练样本，所以我们可以从我们将要使用的原始训练样本中合成一个样本。所以我们可以把我们的数据样本分成三个不同的部分（图1.9）<br>
&emsp;&emsp;&emsp;&emsp;1.训练集：这将作为我们的模型的知识库。通常，会是70%的原始数据样本。<br>
&emsp;&emsp;&emsp;&emsp;2.验证集：这将用于在一组模型中选择性能最好的模型。通常这将是10%的原始数据样本。<br>
&emsp;&emsp;&emsp;&emsp;3.测试集：这将用于测量和报告所选模型的准确性。通常，它与验证集一样大。<br>
![](https://github.com/computeryanjiusheng2018/infodlt/blob/master/content/chapter01/图片8.png) <br>
图 1.9 将数据拆分为训练、验证和测试集。<br>
&emsp;&emsp;如果您只使用一种学习方法，则可以取消验证集，并将数据重新拆分为仅训练和测试集。通常，数据科学家使用75/25或者70/30作为百分比。<br>
### 数据分析预处理
